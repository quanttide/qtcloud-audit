# 元审计规则

## 设计原则

元审计规则是用于评估审计规则质量的最小化标准，原则如下：
- **通用性**：适用于任何类型的审计规则（技术、业务、流程）
- **最小化**：只包含核心要求，避免过度设计
- **渐进式**：规则可以逐步完善，不必一次性满足所有要求
- **实用性**：只要求对实际使用有价值的内容

---

## 1. 规则完整性

### 规则要素完整

**规则描述**：审计规则应包含核心要素，确保规则可理解和可执行。

**审计指标**：
- ✅ 必须包含：规则名称、规则描述
- ✅ 推荐包含：判断标准、检测方法
- ❌ 不允许：仅包含标题或无实质内容

**验收标准**：
- 每个规则至少包含规则名称和描述
- 推荐补充判断标准和检测方法

**示例**：
```markdown
# ❌ 不完整
# 复杂度控制
（无内容）

# ✅ 基础完整
# 复杂度控制
代码复杂度过高会增加维护成本和缺陷风险。

# ✅ 完整
# 复杂度控制
代码复杂度过高会增加维护成本和缺陷风险。

**判断标准**：
- 圈复杂度 ≤ 10：优秀
- 圈复杂度 > 20：不合规

**检测方法**：使用 radon 工具检测
```

---

## 2. 规则可理解性

### 命名清晰

**规则描述**：规则名称应简洁明确，无歧义。

**验收标准**：
- 规则名称能直接表达规则意图
- 避免使用模糊词汇

**示例**：
```markdown
# ❌ 不清晰
# 代码检查
# 好好写代码

# ✅ 清晰
# 函数长度控制
# 代码重复率限制
```

---

### 描述明确

**规则描述**：规则描述应说明规则的目的和要求。

**验收标准**：
- 描述清楚规则要解决的问题
- 描述说明规则的期望状态

**示例**：
```markdown
# ❌ 不明确
代码不能太长。

# ✅ 明确
函数行数过多会导致理解困难，应将长函数拆分为多个小函数。
```

---

## 3. 规则可执行性

### 判断标准明确

**规则描述**：规则应有明确的判断标准，说明如何判断是否违规。

**验收标准**：
- 有明确的数值阈值或判断条件
- 避免使用模糊表述

**示例**：
```markdown
# ❌ 不明确
函数不能太长。

# ✅ 明确
函数行数 > 50：不合规
函数行数 ≤ 30：优秀
```

---

### 检测方法可行

**规则描述**：规则应提供可行的检测方法。

**验收标准**：
- 说明如何执行检测（工具、检查清单、审查流程等）
- 检测方法应可实际执行

**示例**：
```markdown
# ✅ 工具检测
**检测方法**：使用 radon 工具
**执行命令**：radon cc . -a -s

# ✅ 人工检查
**检测方法**：人工审查
**检查要点**：
- 函数是否超过 50 行
- 函数职责是否单一

# ✅ 流程审查
**检测方法**：流程审查
**检查清单**：
- [ ] 是否有设计文档
- [ ] 是否有评审记录
```

---

## 规则检查清单

在创建或修改审计规则时，请使用以下检查清单：

### 基础要求（必须满足）
- [ ] 规则有名称
- [ ] 规则有描述
- [ ] 规则有明确的判断标准
- [ ] 规则有可行的检测方法

### 推荐要求（建议满足）
- [ ] 提供示例（正例、反例）
- [ ] 提供检测工具或命令
- [ ] 说明规则的问题背景

---

## 规则成熟度

审计规则可以按以下阶段逐步完善：

- **阶段 1（基础）**：规则名称 + 描述 + 判断标准
- **阶段 2（可用）**：阶段 1 + 检测方法
- **阶段 3（完善）**：阶段 2 + 示例 + 工具集成

不同阶段的规则都是可用的，随着使用和反馈逐步完善即可。

---

## 规则层级
**通用规则** - 适用于所有审计规则文件
